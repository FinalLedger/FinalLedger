<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <title>Documents</title>
  <link th:replace="/partials/navbar :: bootstrap">
</head>
<body>
<nav th:replace="/partials/navbar :: navbar"></nav>

<div class="container">
  <ul class="nav nav-tabs">
    <li class="nav-item">
      <a class="nav-link" href="/ledger/personal">Personal</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/ledger/medical">Medical</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/ledger/contacts">Contacts</a>
    </li>
    <li class="nav-item">
      <a class="nav-link active" aria-current="page" href="/ledger/documents">Documents</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/ledger/financial">Financial</a>
    </li>
  </ul>
  <br>
  <h1 >Upload Your Important Documents here</h1>
  <h2>You can upload (image files, pdf files, video files and text files) </h2>
  <input type="file" />
  <div class="controls">
    <button id="cancel">Cancel</button>
    <button id="pause">Pause</button>
    <button id="resume">Resume</button>
  </div>
  <div>Progress: <span id="progress"></span></div>

  <script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>
<!--      const client = filestack.init(${fileStack});-->
<!--      const options = {-->
<!--          accept: ["image/*",".pdf",".video/*","text/*"],-->
<!--          storeTo: {-->
<!--          location: 'final_ledger_db',-->
<!--          path: 'jdbc:mysql://localhost:3306/final_ledger_db'-->
<!--        },-->
<!--          uploadConfig: {-->
<!--          retry: 5,-->
<!--          timeout: 60000-->
<!--        },-->
<!--          transformations: {-->
<!--          crop: true,-->
<!--          circle: true,-->
<!--          rotate: true-->
<!--        },-->
<!--        onFileSelected: file => {-->
<!--        // If you throw any error in this function it will reject the file selection.-->
<!--        // The error message will be displayed to the user as an alert.-->
<!--          if (file.size > 1000 * 1000) {-->
<!--          throw new Error('File too big, select something smaller than 1MB');-->
<!--          }-->
<!--        },-->
<!--      };-->
<!--      client.picker().open();-->

  <script>
    window.addEventListener('DOMContentLoaded', function () {
      const apikey = "${fileStack}";
      const client = filestack.init(apikey);

      const onProgress = (evt) => {
        document.getElementById('progress').innerHTML = `${evt.totalPercent}%`;
      };

      document.querySelector('input').addEventListener('change', (event) => {
        const files = event.target.files[0];
        const token = {};
        const cancel = document.getElementById('cancel');
        const pause = document.getElementById('pause');
        const resume = document.getElementById('resume');

        [cancel, resume, pause].forEach((btn) => {
          const id = btn.id;
          btn.addEventListener('click', () => {
            token[id]();
          });
        });

        client.upload(files, { onProgress }, {}, token)
                .then(res => {
                  console.log('success: ', res)
                })
                .catch(err => {
                  console.log(err)
                });
      });
    });
  </script>


</div>
</body>
</html>